import{v as ue,H as le,G as oe,_ as ne}from"./index.4ad22c22.js";/* empty css                *//* empty css                *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css                *//* empty css              *//* empty css                *//* empty css                *//* empty css               *//* empty css               */import{d as de,j as g,c as se,w as ie,b1 as re,C as s,D as p,aI as t,aH as e,aK as A,aJ as C,aE as _,aM as d,aN as m,G as V,aF as v,aX as G,b7 as ce,b8 as pe,bQ as _e,bR as me,bd as ve,b2 as fe,K as Fe,I as ge,bn as he,ag as Ee,aY as xe,af as be,bW as ke,bX as Ae,bY as Ce}from"./arco.b6dedf2e.js";import{u as Be}from"./loading.f776d3e0.js";import{h as De,i as Ve}from"./auth.8de74d75.js";import{c as I}from"./cloneDeep.7f42bec5.js";import"./chart.94e2d85e.js";import"./vue.02736e06.js";const Ie={class:"container"},ye={style:{padding:"5px 0","font-size":"15px",color:"black"}},we={key:0,style:{"padding-left":"10px"}},Te={style:{padding:"5px","font-size":"15px",color:"black"}},Se={key:0,style:{padding:"15px"}},Le={style:{display:"flex"}},Ne={name:"ApiList"},Ue=de({...Ne,setup($e){const y=g(),h=g(!1),b=g({}),{loading:qe,setLoading:w}=Be(!0),{t:T}=ue.exports.useI18n(),l=g({title:"",method:"",path:"",scope:"",group:"",need_login:0,need_auth:0}),k=g([]),r=g({}),P=g([]),z=se(()=>[{title:T("searchTable.columns.index"),dataIndex:"id"},{title:"api \u540D\u79F0",dataIndex:"title"},{title:"\u8BF7\u6C42\u65B9\u5F0F",dataIndex:"method",slotName:"method"},{title:"path",dataIndex:"path"},{title:"\u767B\u5F55",dataIndex:"need_login",slotName:"need_login"},{title:"\u9274\u6743",dataIndex:"need_auth",slotName:"need_auth"},{title:T("searchTable.columns.operations"),dataIndex:"operations",fixed:"right",width:200,slotName:"operation"}]),S=(o,a)=>{r.value[o][a]?delete r.value[o][a]:r.value[o][a]="show"},L=o=>{r.value[o]?delete r.value[o]:r.value[o]={}},M=()=>{y.value.validate(async o=>{o||await De(l.value).then(a=>{a.code===2e4?(h.value=!1,G.success("\u4FDD\u5B58\u6210\u529F"),N()):G.error("\u4FEE\u6539\u5931\u8D25")})})},R=o=>{},N=async()=>{w(!0);try{const o=await Ve();b.value=o.data}catch{}finally{w(!1)}},j=o=>{l.value=I(o),h.value=!0};return N(),ie(()=>z.value,o=>{k.value=I(o),k.value.forEach((a,B)=>{a.checked=!0}),P.value=I(k.value)},{deep:!0,immediate:!0}),(o,a)=>{const B=ce,f=pe,c=_e,E=me,H=ve,X=fe,Y=re("Breadcrumb"),J=le,U=Fe,$=ge,Q=oe,q=he,W=Ee,O=xe,Z=be,K=ke,ee=Ae,te=Ce;return s(),p("div",Ie,[t(X,{title:"\u7F16\u8F91 Api",visible:h.value,onOk:M,onClose:a[7]||(a[7]=u=>h.value=!1),onCancel:a[8]||(a[8]=u=>h.value=!1)},{default:e(()=>[t(H,{ref_key:"EditForm",ref:y,model:l.value},{default:e(()=>[t(f,{field:"title","validate-trigger":["change","input"],rules:[{required:!0,message:"\u63A5\u53E3\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],label:"Api \u540D\u79F0"},{default:e(()=>[t(B,{modelValue:l.value.title,"onUpdate:modelValue":a[0]||(a[0]=u=>l.value.title=u)},null,8,["modelValue"])]),_:1}),t(f,{label:"path"},{default:e(()=>[t(B,{modelValue:l.value.path,"onUpdate:modelValue":a[1]||(a[1]=u=>l.value.path=u),disabled:""},null,8,["modelValue"])]),_:1}),t(f,{field:"scope",label:"Scope","validate-trigger":["change","input"],rules:[{required:!0,message:"Scope \u4E0D\u80FD\u4E3A\u7A7A"}]},{default:e(()=>[t(E,{modelValue:l.value.scope,"onUpdate:modelValue":a[2]||(a[2]=u=>l.value.scope=u),placeholder:"\u8BF7\u9009\u62E9 Scope","allow-create":""},{default:e(()=>{var u;return[(s(!0),p(A,null,C((u=b.value)==null?void 0:u.all_scope,(x,n)=>(s(),_(c,{key:n,value:n},{default:e(()=>[d(m(n),1)]),_:2},1032,["value"]))),128))]}),_:1},8,["modelValue"])]),_:1}),t(f,{field:"group","validate-trigger":["change","input"],rules:[{required:!0,message:"\u5206\u7EC4\u4E0D\u80FD\u4E3A\u7A7A"}],label:"\u5206\u7EC4"},{default:e(()=>[t(E,{modelValue:l.value.group,"onUpdate:modelValue":a[3]||(a[3]=u=>l.value.group=u),placeholder:"\u8BF7\u9009\u62E9 Scope","allow-create":""},{default:e(()=>{var u;return[(s(!0),p(A,null,C((u=b.value.all_scope)==null?void 0:u[l.value.scope],(x,n)=>(s(),_(c,{key:n,value:x},{default:e(()=>[d(m(x),1)]),_:2},1032,["value"]))),128))]}),_:1},8,["modelValue"])]),_:1}),t(f,{"validate-trigger":["change","input"],rules:[{required:!0,message:"\u8BF7\u6C42\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A"}],label:"\u8BF7\u6C42\u65B9\u5F0F"},{default:e(()=>[t(E,{modelValue:l.value.method,"onUpdate:modelValue":a[4]||(a[4]=u=>l.value.method=u),placeholder:"\u8BF7\u9009\u62E9\u8BF7\u6C42\u65B9\u5F0F","allow-create":""},{default:e(()=>[t(c,{value:"GET"},{default:e(()=>[d("GET")]),_:1}),t(c,{value:"POST"},{default:e(()=>[d("POST")]),_:1}),t(c,{value:"DELETE"},{default:e(()=>[d("DELETE")]),_:1}),t(c,{value:"PUT"},{default:e(()=>[d("PUT")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"\u767B\u5F55","validate-trigger":["change","input"],rules:[{required:!0,message:"\u662F\u5426\u767B\u5F55\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:e(()=>[t(E,{modelValue:l.value.need_login,"onUpdate:modelValue":a[5]||(a[5]=u=>l.value.need_login=u),placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u767B\u5F55"},{default:e(()=>[t(c,{value:1},{default:e(()=>[d("\u662F")]),_:1}),t(c,{value:2},{default:e(()=>[d("\u5426")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"\u9274\u6743","validate-trigger":["change","input"],rules:[{required:!0,message:"\u662F\u5426\u9274\u6743\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:e(()=>[t(E,{modelValue:l.value.need_auth,"onUpdate:modelValue":a[6]||(a[6]=u=>l.value.need_auth=u),placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u9274\u6743"},{default:e(()=>[t(c,{value:1},{default:e(()=>[d("\u662F")]),_:1}),t(c,{value:2},{default:e(()=>[d("\u5426")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),t(Y,{items:["\u6743\u9650\u7BA1\u7406","Api \u5217\u8868"]}),t(te,{class:"general-card",title:"Api \u5217\u8868"},{default:e(()=>{var u;return[(s(!0),p(A,null,C((u=b.value)==null?void 0:u.formatted_list,(x,n)=>(s(),p("div",{key:n},[V("div",ye,[t(J),d(" "+m(n)+" ",1),r.value[n]?v("",!0):(s(),_(U,{key:0,style:{cursor:"pointer"},onClick:D=>L(n)},null,8,["onClick"])),r.value[n]?(s(),_($,{key:1,style:{cursor:"pointer"},onClick:D=>L(n)},null,8,["onClick"])):v("",!0)]),r.value[n]?(s(),p("div",we,[(s(!0),p(A,null,C(x,(D,F)=>(s(),p("div",{key:F},[V("div",Te,[t(Q),d(" "+m(F)+" ",1),r.value[n][F]?v("",!0):(s(),_(U,{key:0,style:{cursor:"pointer"},onClick:i=>S(n,F)},null,8,["onClick"])),r.value[n][F]?(s(),_($,{key:1,style:{cursor:"pointer"},onClick:i=>S(n,F)},null,8,["onClick"])):v("",!0)]),r.value[n][F]?(s(),p("div",Se,[t(ee,{size:"small",columns:k.value,"row-key":"id",data:D},{method:e(({record:i})=>[i.method==="GET"?(s(),_(q,{key:0,color:"green"},{default:e(()=>[d(m(i.method),1)]),_:2},1024)):v("",!0),i.method==="POST"?(s(),_(q,{key:1,color:"cyan"},{default:e(()=>[d(m(i.method),1)]),_:2},1024)):v("",!0)]),need_login:e(({record:i})=>[d(m(i.need_login===1?"\u662F":"\u5426"),1)]),need_auth:e(({record:i})=>[d(m(i.need_auth===1?"\u662F":"\u5426"),1)]),operation:e(({record:i})=>[V("div",Le,[t(O,{type:"text",size:"small",onClick:ae=>j(i)},{icon:e(()=>[t(W)]),default:e(()=>[d(" \u7F16\u8F91 ")]),_:2},1032,["onClick"]),t(K,{content:"\u786E\u5B9A\u5220\u9664\u63A5\u53E3 ["+i.title+"]?",onOk:ae=>R(i)},{default:e(()=>[t(O,{type:"text",size:"small"},{icon:e(()=>[t(Z)]),default:e(()=>[d(" \u5220\u9664 ")]),_:1})]),_:2},1032,["content","onOk"])])]),_:2},1032,["columns","data"])])):v("",!0)]))),128))])):v("",!0)]))),128))]}),_:1})])}}});const lt=ne(Ue,[["__scopeId","data-v-d54352e3"]]);export{lt as default};
