import{v as ze,r as Be,B as Ie,k as Ee,C as Ae,_ as $e}from"./index.4ad22c22.js";/* empty css                *//* empty css                *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css                *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css                */import{d as Se,j as c,r as Ve,c as J,w as Ne,b1 as Me,C as d,D as h,aI as t,aH as e,G as l,aM as u,aN as r,aK as O,aJ as Z,aE as B,E as Re,u as Ke,aX as Q,n as Le,bZ as Pe,bx as Ue,bu as qe,a_ as je,b7 as He,b8 as Xe,bT as Ye,bU as Ge,bd as Je,bV as Oe,ac as Ze,aY as Qe,bc as We,a6 as et,bz as tt,bA as at,bB as nt,ba as ot,bD as st,bo as lt,ag as it,bX as ct,bY as ut,be as rt,bf as dt}from"./arco.b6dedf2e.js";import{u as pt}from"./loading.f776d3e0.js";import{j as mt,q as _t,k as vt,l as ht,m as ft}from"./auth.8de74d75.js";import{c as f}from"./cloneDeep.7f42bec5.js";import{S as gt}from"./sortable.esm.9c6bb8d9.js";import"./chart.94e2d85e.js";import"./vue.02736e06.js";const K=T=>(rt("data-v-4ba8900c"),T=T(),dt(),T),bt={class:"container"},yt={style:{padding:"15px"}},kt={style:{padding:"15px"}},Ct={style:{display:"flex",gap:"50px"}},Tt={class:"action-icon"},xt={class:"action-icon"},wt={id:"tableSetting"},Ft={style:{"margin-right":"4px",cursor:"move"}},Dt={class:"title"},zt=K(()=>l("img",{alt:"avatar",src:"//p3-armor.byteimg.com/tos-cn-i-49unhts6dw/581b17753093199839f2e327e726b157.svg~tplv-49unhts6dw-image.image"},null,-1)),Bt=K(()=>l("img",{alt:"avatar",src:"//p3-armor.byteimg.com/tos-cn-i-49unhts6dw/77721e365eb2ab786c889682cbc721c1.svg~tplv-49unhts6dw-image.image"},null,-1)),It=K(()=>l("img",{alt:"avatar",src:"//p3-armor.byteimg.com/tos-cn-i-49unhts6dw/ea8b09190046da0ea7e070d83c5d1731.svg~tplv-49unhts6dw-image.image"},null,-1)),Et={key:0,class:"circle"},At={key:1,class:"circle pass"},$t={name:"RolesList"},St=Se({...$t,setup(T){const I=c({tree:[],api_list:{},menu_list:[]}),g=c(!1),L=()=>({id:0,name:"",description:"",created_time:"",updated_time:""}),x=c([]),w=c([]),b=c([]),F=c([]),{loading:W,setLoading:P}=pt(!0),{t:v}=ze.exports.useI18n(),U=c([]),p=c(L()),_=c([]),D=c([]),E=c({name:"",pageSize:20,current:1}),A=c("medium"),q={current:1,pageSize:20},y=Ve({...q}),ee=J(()=>[{name:v("searchTable.size.mini"),value:"mini"},{name:v("searchTable.size.small"),value:"small"},{name:v("searchTable.size.medium"),value:"medium"},{name:v("searchTable.size.large"),value:"large"}]),te=J(()=>[{title:v("searchTable.columns.index"),dataIndex:"id"},{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"name"},{title:"\u63CF\u8FF0",dataIndex:"description"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created_time"},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"updated_time"},{title:v("searchTable.columns.operations"),dataIndex:"operations",fixed:"right",width:200,slotName:"operations"}]),ae=async()=>{const a=await mt();I.value=a.data},$=async a=>{P(!0);try{const{data:o}=await _t(a);U.value=o.list,y.current=a.current,y.total=o.total}catch{}finally{P(!1)}},ne=()=>{},oe=async a=>{p.value=f(a);const{data:o}=await vt(a.id);x.value=o.menu,F.value=o.api,b.value=f(F.value),w.value=f(x.value),g.value=!0},se=a=>{console.log(b.value);const o=a.filter(s=>!b.value.includes(s)),i=b.value.filter(s=>!a.includes(s));ht({role_id:p.value.id,add:o,remove:i}).then(s=>{s.code!==2e4&&Q.error("\u4FEE\u6539\u5931\u8D25,\u8BF7\u5237\u65B0\u9875\u9762")}),b.value=[...a]},le=a=>{const o=a.filter(s=>!w.value.includes(s)),i=w.value.filter(s=>!a.includes(s));ft({role_id:p.value.id,add:o,remove:i}).then(s=>{s.code!==2e4&&Q.error("\u4FEE\u6539\u5931\u8D25,\u8BF7\u5237\u65B0\u9875\u9762")}),w.value=[...a]},j=()=>{$({...q,...p.value})},ie=a=>{E.value.current=a,$(E.value)};ae(),$(E.value);const ce=()=>{p.value=L()},ue=(a,o)=>{A.value=a},re=(a,o,i)=>{a?_.value.splice(i,0,o):_.value=D.value.filter(s=>s.dataIndex!==o.dataIndex)},H=(a,o,i,s=!1)=>{const m=s?f(a):a;return o>-1&&i>-1&&m.splice(o,1,m.splice(i,1,m[o]).pop()),m},de=a=>{a&&Le(()=>{const o=document.getElementById("tableSetting");new gt(o,{onEnd(i){const{oldIndex:s,newIndex:m}=i;H(_.value,s,m),H(D.value,s,m)}})})};return Ne(()=>te.value,a=>{_.value=f(a),_.value.forEach((o,i)=>{o.checked=!0}),D.value=f(_.value)},{deep:!0,immediate:!0}),(a,o)=>{const i=Pe,s=Ue,m=qe,pe=je,me=Me("Breadcrumb"),_e=He,ve=Xe,k=Ye,S=Ge,he=Je,X=Oe,fe=Ze,C=Qe,Y=Be,V=We,ge=et,N=tt,be=Ie,ye=at,ke=nt,G=Ee,Ce=Ae,Te=ot,xe=st,M=lt,we=it,Fe=ct,De=ut;return d(),h("div",bt,[t(pe,{width:600,onOk:o[2]||(o[2]=n=>g.value=!1),visible:g.value,title:"\u8BBE\u7F6E[ "+p.value.name+" ]\u6743\u9650\u8282\u70B9",onCancel:o[3]||(o[3]=n=>g.value=!1),onClose:o[4]||(o[4]=n=>g.value=!1)},{title:e(()=>[]),default:e(()=>[l("div",null,[t(m,{"default-active-key":"1",type:"card",size:"large"},{default:e(()=>[t(s,{key:"1",type:"card"},{title:e(()=>[u("\u83DC\u5355\u6743\u9650")]),default:e(()=>[l("div",yt,[t(i,{onCheck:le,onChange:ne,"check-strictly":!0,"checked-keys":x.value,"onUpdate:checkedKeys":o[0]||(o[0]=n=>x.value=n),"field-names":{key:"id",title:"title",children:"children"},checkable:!0,data:I.value.menu_list},null,8,["checked-keys","data"])])]),_:1}),t(s,{key:"2"},{title:e(()=>[u("Api \u6743\u9650")]),default:e(()=>[l("div",kt,[t(i,{blockNode:"",onCheck:se,"checked-keys":F.value,"onUpdate:checkedKeys":o[1]||(o[1]=n=>F.value=n),"field-names":{key:"id",title:"title",path:"path",children:"children"},checkable:!0,data:I.value.tree},{title:e(({title:n,path:z})=>[l("div",Ct,[l("div",null,r(n||"\u672A\u547D\u540D\u63A5\u53E3"),1),l("div",null,r(z),1)])]),_:1},8,["checked-keys","data"])])]),_:1})]),_:1})])]),_:1},8,["visible","title"]),t(me,{items:["\u6743\u9650\u7BA1\u7406","\u89D2\u8272\u5217\u8868"]}),t(De,{class:"general-card",title:a.$t("menu.list.searchTable")},{default:e(()=>[t(S,null,{default:e(()=>[t(k,{flex:1},{default:e(()=>[t(he,{model:p.value,"label-col-props":{span:6},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(S,{gutter:16},{default:e(()=>[t(k,{span:8},{default:e(()=>[t(ve,{field:"number",label:"\u89D2\u8272\u540D\u79F0"},{default:e(()=>[t(_e,{modelValue:p.value.name,"onUpdate:modelValue":o[5]||(o[5]=n=>p.value.name=n),placeholder:"\u89D2\u8272\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(X,{style:{height:"84px"},direction:"vertical"}),t(k,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[t(V,{direction:"vertical",size:18},{default:e(()=>[t(C,{type:"primary",onClick:j},{icon:e(()=>[t(fe)]),default:e(()=>[u(" "+r(a.$t("searchTable.form.search")),1)]),_:1}),t(C,{onClick:ce},{icon:e(()=>[t(Y)]),default:e(()=>[u(" "+r(a.$t("searchTable.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(X,{style:{"margin-top":"0"}}),t(S,{style:{"margin-bottom":"16px"}},{default:e(()=>[t(k,{span:12},{default:e(()=>[t(V,null,{default:e(()=>[t(C,{type:"primary"},{icon:e(()=>[t(ge)]),default:e(()=>[u(" "+r(a.$t("searchTable.operation.create")),1)]),_:1})]),_:1})]),_:1}),t(k,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:e(()=>[t(N,{content:a.$t("searchTable.actions.refresh")},{default:e(()=>[l("div",{class:"action-icon",onClick:j},[t(Y,{size:"18"})])]),_:1},8,["content"]),t(ke,{onSelect:ue},{content:e(()=>[(d(!0),h(O,null,Z(ee.value,n=>(d(),B(ye,{key:n.value,value:n.value,class:Re({active:n.value===A.value})},{default:e(()=>[l("span",null,r(n.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[t(N,{content:a.$t("searchTable.actions.density")},{default:e(()=>[l("div",Tt,[t(be,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(N,{content:a.$t("searchTable.actions.columnSetting")},{default:e(()=>[t(xe,{trigger:"click",position:"bl",onPopupVisibleChange:de},{content:e(()=>[l("div",wt,[(d(!0),h(O,null,Z(D.value,(n,z)=>(d(),h("div",{key:n.dataIndex,class:"setting"},[l("div",Ft,[t(Ce)]),l("div",null,[t(Te,{modelValue:n.checked,"onUpdate:modelValue":R=>n.checked=R,onChange:R=>re(R,n,z)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),l("div",Dt,r(n.title==="#"?"\u5E8F\u5217\u53F7":n.title),1)]))),128))])]),default:e(()=>[l("div",xt,[t(G,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(Fe,{"row-key":"id",loading:Ke(W),pagination:y,columns:_.value,data:U.value,bordered:!1,size:A.value,onPageChange:ie},{index:e(({rowIndex:n})=>[u(r(n+1+(y.current-1)*y.pageSize),1)]),contentType:e(({record:n})=>[t(V,null,{default:e(()=>[n.contentType==="img"?(d(),B(M,{key:0,size:16,shape:"square"},{default:e(()=>[zt]),_:1})):n.contentType==="horizontalVideo"?(d(),B(M,{key:1,size:16,shape:"square"},{default:e(()=>[Bt]),_:1})):(d(),B(M,{key:2,size:16,shape:"square"},{default:e(()=>[It]),_:1})),u(" "+r(a.$t(`searchTable.form.contentType.${n.contentType}`)),1)]),_:2},1024)]),filterType:e(({record:n})=>[u(r(a.$t(`searchTable.form.filterType.${n.filterType}`)),1)]),status:e(({record:n})=>[n.status==="offline"?(d(),h("span",Et)):(d(),h("span",At)),u(" "+r(a.$t(`searchTable.form.status.${n.status}`)),1)]),operations:e(({record:n})=>[t(C,{type:"text",size:"small"},{icon:e(()=>[t(we)]),default:e(()=>[u(" \u7F16\u8F91 ")]),_:1}),t(C,{type:"text",size:"small",onClick:z=>oe(n)},{icon:e(()=>[t(G)]),default:e(()=>[u(" \u8BBE\u7F6E\u6743\u9650 ")]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size"])]),_:1},8,["title"])])}}});const la=$e(St,[["__scopeId","data-v-4ba8900c"]]);export{la as default};
